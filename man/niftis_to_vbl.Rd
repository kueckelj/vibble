% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vibble-io-nifti.R
\name{niftis_to_vbl}
\alias{niftis_to_vbl}
\title{Read multiple NIfTI files into a merged vibble.}
\usage{
niftis_to_vbl(
  x,
  rgx_fp = ".*",
  rgx_var = ".*",
  strip_var = NULL,
  recursive = FALSE,
  join = "full",
  .rfn = NULL,
  rm0 = FALSE,
  verbose = vbl_opts("verbose")
)
}
\arguments{
\item{x}{Character. Either a folder directory containing NIfTI files or a character vector
of file paths.}

\item{rgx_fp}{Character scalar. Regular expression applied to file paths to retain only
matching NIfTI files.}

\item{rgx_var}{Character scalar. Regular expression used to extract variable names from
the basename (without extension) of each NIfTI file.}

\item{strip_var}{Characte vector. A set of \code{pattern} inputs that are stripped from variable
names via \link{str_remove_all}().}

\item{recursive}{Logical. If \code{TRUE} and \code{x} is a directory it is searched recursively for NIfTI files.}

\item{join}{Type of join to perform. One of \code{"full"}, \code{"inner"}, \code{"left"},
or \code{"right"}. Determines how voxel coordinates absent in one input are treated.}

\item{.rfn}{Optional renaming function or formula applied to all non-coordinate
variables of \code{b} before joining (e.g., \code{~ paste0(.x, "_b")}).}
}
\value{
A merged \link{vibble} containing one voxel variable per input file.
Variable names correspond to the values extracted via \code{rgx_var}.
}
\description{
Convert one or more NIfTI files into a single \link{vibble} by reading
all matching files, extracting variable names from filenames, and
merging the resulting vibbles using \code{join_vibbles()}.
}
\details{
The function operates on either:
\itemize{
\item a directory (single-character string) containing NIfTI files, or
\item a character vector of file paths.
}

All files ending in \code{.nii.gz} are collected.
These paths can be filtered using a regular expression (\code{rgx_fp}), and
variable names used for each file are extracted from the filename using
\code{rgx_var}. Each extracted variable name must be unique.

For each file, \code{nifti_to_vbl()} is called with \code{rm0} and
\code{verbose} forwarded. The resulting list of vibbles is then merged into
a single vibble using \code{purrr::reduce()} and \code{join_vibbles()} with
the join type specified in \code{join}.

Errors are thrown if:
\itemize{
\item no NIfTI files are found,
\item file-path filtering removes all files,
\item variable names cannot be extracted from some filenames,
\item extracted variable names are duplicated.
}
}
\examples{
\dontrun{
# Read all NIfTI files in a directory
v <- niftis_to_vbl("data/images/", rgx_var = "^[A-Za-z]+")

# From explicit file list
files <- c("t1.nii.gz", "flair.nii.gz", "mask.nii.gz")
v <- niftis_to_vbl(files, rgx_var = "^[A-Za-z]+")

# Restrict to files with "_orig" in their name
v <- niftis_to_vbl("data/", rgx_fp = "_orig", rgx_var = "^[A-Za-z]+")
}

}
