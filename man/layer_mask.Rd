% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ggvibble-layers-var.R
\name{layer_mask}
\alias{layer_mask}
\title{Add a color layer for mask}
\usage{
layer_mask(
  color,
  opacity = 0.25,
  fill = TRUE,
  outline = FALSE,
  concavity = 2.5,
  nv = 50,
  var = NULL,
  .cond = NULL,
  .by = NULL,
  ...
)
}
\arguments{
\item{color}{Color used for the mask fill and outline.}

\item{opacity}{Controls voxel transparency. Accepts constants, ranges, or
data-masked expressions. See section \emph{Opacity options} for details.}

\item{fill}{Logical. If \code{TRUE}, draw a filled raster layer over mask voxels.}

\item{outline}{Logical. If \code{TRUE}, draw polygon outlines around connected
mask regions.}

\item{concavity}{Numeric passed to \link{concaveman}() to control the shape
of the concave hull used for outlines.}

\item{nv}{Integer. Number of vertices used by \code{densify_poly()} to densify each
polygon outline.}

\item{var}{Character or \code{NULL}. If character, specifies a logical variables
in the vibble based on which the masks are created.}

\item{.cond}{Optional. An additional logical filter expression that determines the specific
voxels for which this layer is drawn. The expression is evaluated via
\link[rlang:args_data_masking]{data-masking} semantics with the 2D vibble passed
into this layer by \link{ggplane}(). See \link[=ggvibble_doc_cond]{Details} for more information and examples.}

\item{.by}{Optional. A \link[dplyr:dplyr_tidy_select]{tidy-selection} of columns to
group by before applying the filtering logic of \code{.cond}.}

\item{...}{Additional arguments passed to \link{geom_polygon}() for the outline.}
}
\value{
A \code{ggvibble_layer} object containing the supplied function. When
added to a \code{ggvibble}, the function is executed and its returned layers are
inserted into the plot.
}
\description{
Overlay a logical mask on a \link{ggplane}() plot by filling
voxels and/or drawing polygon outlines.
}
\note{
If neither \code{var} nor \code{.cond} is specified, the masks mask every voxel in every slice
of the 2D vibble passed to this layer by \code{ggplane()}.
}
\section{Opacity options}{

The \code{opacity} parameter supports constant, ranged, and voxel-wise inputs.
In all cases, the used values are guaranteed to lie within \verb{[0,1]},
where \code{0} corresponds to full opacity (completely invisible) and \code{1}
corresponds to full opacity (no shine-through).

It is interpreted as follows:

\itemize{

\item \strong{Single numeric value: }
A constant opacity in \verb{[0,1]} applied to all voxels.
No scaling is performed. Example A.

\item \strong{Numeric vector of length 2: }
Interpreted as a lower and upper opacity bound. The numeric variable being plotted
is rescaled into this interval, with the input range given by \link{var_limits}\verb{(vbl2D, var)}.
Restricted to \link{layer_numeric_var()}. Example B.

\item \strong{Data-masked expressions: }
Any expression using column names of \code{vbl2D} are evaluated with
\link{eval_tidy}(), meaning variable names refer to columns rather than
R objects. See \link[rlang:args_data_masking]{data-masking}. Example C.

\item \strong{Invalid input: }
Non-numeric inputs or numeric vectors of unsupported length cause an error.
Example D.

}
}

